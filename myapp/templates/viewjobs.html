{% extends "base.html" %}

{% block title %}Jobs List{% endblock %}

{% block content %}
    <div class="container mx-auto px-4 py-8">
    <div class="flex items-center justify-between mb-6">
        <!-- Left: Heading -->
        <h1 class="text-3xl font-bold">Jobs List</h1>

        <!-- Right: controls grouped -->
        <div class="flex items-center gap-6">
        <!-- Filter dropdown -->
        <form method="GET" action="{{ url_for('main.filter_joblistings') }}" class="min-w-[180px]">
            <select name="hr_id" id="hr_id" class="select select-bordered w-full" onchange="this.form.submit()">
            <option value="">Filter by</option>
            {% for hr in users %}
                <option value="{{ hr.id }}" {% if request.args.get('hr_id')|string == hr.id|string %}selected{% endif %}>
                {{ hr.name if hr.name else hr.username }}
                </option>
            {% endfor %}
            </select>
        </form>

        <!-- Search form -->
        <form method="GET" action="{{ url_for('main.search_job') }}" class="flex gap-2 min-w-[250px]">
            <input
            type="text"
            name="q"
            placeholder="Search jobs..."
            class="input input-bordered flex-grow"
            required
            />
            <button type="submit" class="btn btn-primary whitespace-nowrap">Search</button>
        </form>

        <!-- Total jobs count -->
        <div class="stat text-center min-w-[100px]">
            <div class="stat-title">Total Jobs</div>
            <div class="stat-value">{{ jobs|length }}</div>
        </div>
        </div>
    </div>
    </div>

    {% if jobs %}
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
        {% for job in jobs %}
            <div class="card bg-base-100 shadow-lg rounded-lg flex flex-col justify-between p-6 text-center">
                <div class="flex flex-col items-center">
                    <h2 class="text-xl font-bold mb-2">{{ job.position }}</h2>
                    <p class="text-gray-700 mb-4">{{ job.skillset }}</p>
                    <p class="text-gray-700 mb-4">{{ job.experience }} years</p>
                    <p class="text-sm text-gray-500 mb-4">Added by: {{ job.created_by.username if job.created_by else 'Unknown' }}</p>
                </div>

                <!-- View Description button -->
                <div class="flex justify-center mt-auto">
                    <a href="{{ url_for('main.view_details_joblisting', id=job.id) }}" class="btn btn-info w-auto px-6">
                        View Description
                    </a>
                </div>

            </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-8">
        <div class="text-6xl mb-4">üìù</div>
        <h3 class="text-xl font-semibold mb-2">No Jobs Available</h3>
        <p class="text-gray-600">There are currently no job openings.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
